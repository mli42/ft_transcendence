FROM node:16-alpine3.11

WORKDIR /app_frontend

# Vue.JS
RUN npm i -g vue @vue/cli @vue/cli-service

# HTTPS
ARG SSLPATH="/etc/ssl/pong"
ARG SSLNAME="server"

RUN apk add openssl && \
	mkdir -p ${SSLPATH} && \
	openssl req -new -x509 -nodes -sha256 -days 365 -newkey rsa:2048 \
	-subj "/C=FR/ST=75/L=Paris" \
	-keyout "${SSLPATH}/${SSLNAME}.key" -out "${SSLPATH}/${SSLNAME}.crt"

EXPOSE 3030

ENV NUXT_HOST=0.0.0.0
ENV NUXT_PORT=3030

# Dependencies from package.json and start the server
ENTRYPOINT npm install && npm run dev
